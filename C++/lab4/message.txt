Complementary work needed, see TODOs in code. Sorry for a late reply.
